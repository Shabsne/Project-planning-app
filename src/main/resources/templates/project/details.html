<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${project.name}">Project Details</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<h1 th:text="${project.name}">Project Name</h1>

<p><strong>Description:</strong> <span th:text="${project.description}"></span></p>
<p><strong>Start:</strong> <span th:text="${project.startDate}"></span></p>
<p><strong>End:</strong> <span th:text="${project.endDate}"></span></p>
<p><strong>Samlede Estimerede Timer:</strong>
    <span th:text="${totalEstimatedHours}"></span> timer
</p>
<p><strong>Project Leader:</strong>
    <span th:text="${project.projectLeader != null ? project.projectLeader.name : 'Not Assigned'}"></span>
</p>


<hr>

<!-- Edit / Delete Actions -->
<a th:href="@{/projects/{id}/edit(id=${project.id})}">Edit Project</a>

<form th:action="@{/projects/{id}/delete(id=${project.id})}" method="post" style="display:inline;">
    <button type="submit">Delete Project</button>
</form>

<hr>

<!-- Parent Project -->
<h2>Parent Project</h2>
<div th:if="${project.parentProject != null}">
    <a th:href="@{/projects/{id}(id=${project.parentProject.id})}"
       th:text="${project.parentProject.name}"></a>
</div>
<div th:if="${project.parentProject == null}">
    <p>No parent (this is a root project)</p>
</div>

<hr>

<!-- Subprojects (only visible if this is a parent-project) -->
<div th:if="${project.parentProject == null}">
    <h2>Subprojects</h2>

    <a th:href="@{/projects/{id}/sub/create(id=${project.id})}">Create Subproject</a>

    <table th:if="${project.subProjects != null and !#lists.isEmpty(project.subProjects)}">
        <tr><th>Name</th><th>Project Leader</th></tr>
        <tr th:each="sp : ${project.subProjects}">
            <td>
                <a th:href="@{/projects/{id}(id=${sp.id})}"
                   th:text="${sp.name}"></a>
            </td>
            <td th:text="${sp.projectLeader != null ? sp.projectLeader.name : 'Not Assigned'}"></td>
        </tr>
    </table>

    <p th:if="${project.subProjects == null || #lists.isEmpty(project.subProjects)}">
        No subprojects yet.
    </p>
</div>

<hr>

    <!-- Root Tasks -->
    <h3>Root Tasks</h3>
    <table>
        <tr>
            <th>Title</th>
            <th>Status</th>
            <th>Deadline</th>
        </tr>
        <tr th:each="task : ${rootTasks}">
            <td>
                <a th:href="@{/projects/{projectId}/tasks/{taskId}(projectId=${project.id}, taskId=${task.taskId})}"
                   th:text="${task.title}"></a>
            </td>
            <td th:text="${task.status}"></td>
            <td th:text="${#temporals.format(task.deadline, 'dd-MM-yyyy HH:mm')}"></td>
        </tr>
    </table>





    <hr>
<!-- Tasks -->
<h2>Tasks</h2>
<table>
    <tr><th>Title</th><th>Status</th></tr>
    <tr th:each="t : ${project.tasks}">
        <td th:text="${t.title}"></td>
        <td th:text="${t.status}"></td>
    </tr>
</table>

<br>
<a th:href="@{/projects/{id}/createTask(id=${project.id})}">+ Create New Task</a>

<hr>

<!-- Employees -->
<h2>Assigned Employees</h2>
<table>
    <tr><th>Name</th><th>Email</th></tr>
    <tr th:each="e : ${project.assignedEmployees}">
        <td th:text="${e.name}"></td>
        <td th:text="${e.email}"></td>
    </tr>
</table>

<br>
<a href="/projects">â¬… Back to list</a>

</body>
</html>

